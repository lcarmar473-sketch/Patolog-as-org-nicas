<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simulador de Primeros Auxilios - RA2.G</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap');
        body { font-family: 'Inter', sans-serif; }
    </style>
</head>
<body class="bg-slate-50">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // Componente de Iconos para que funcionen en el navegador
        const Icon = ({ name, className }) => {
            useEffect(() => { lucide.createIcons(); }, [name]);
            return <i data-lucide={name} className={className}></i>;
        };

        const App = () => {
            const [activeTab, setActiveTab] = useState('learning');
            const [selectedPathology, setSelectedPathology] = useState(null);
            const [quizStarted, setQuizStarted] = useState(false);
            const [currentQuestion, setCurrentQuestion] = useState(0);
            const [score, setScore] = useState(0);
            const [showResult, setShowResult] = useState(false);
            const [feedback, setFeedback] = useState(null);

            const pathologies = [
                {
                    id: 'cardio',
                    title: 'Urgencias Cardiovasculares',
                    subtitle: 'Infarto Agudo (IAM)',
                    icon: 'heart',
                    color: 'text-red-500',
                    border: 'border-red-500',
                    bg: 'bg-red-50',
                    symptoms: ['Dolor opresivo en el pecho', 'Irradiación a brazo izquierdo o mandíbula', 'Sudoración fría y náuseas'],
                    actions: [
                        { step: 'Reposo', text: 'Sentar con espalda apoyada.' },
                        { step: '112', text: 'Aviso inmediato sospecha Código Infarto.' },
                        { step: 'Confort', text: 'Aflojar ropa ajustada.' }
                    ]
                },
                {
                    id: 'neuro',
                    title: 'Urgencias Neurológicas',
                    subtitle: 'Ictus / ACV',
                    icon: 'brain',
                    color: 'text-purple-500',
                    border: 'border-purple-500',
                    bg: 'bg-purple-50',
                    symptoms: ['Boca torcida', 'Dificultad para hablar', 'Falta de fuerza en un brazo'],
                    actions: [
                        { step: 'FAST', text: 'Comprobar cara, brazos y habla.' },
                        { step: 'Tiempo', text: 'Anotar la hora exacta de inicio.' },
                        { step: 'Posición', text: 'Cabeza elevada 30º si está consciente.' }
                    ]
                }
            ];

            const quiz = [
                {
                    case: "Hombre de 55 años con dolor intenso en el pecho. Dice que siente 'fuego' y el dolor sube a su mandíbula.",
                    options: ["Elevar piernas", "Posición semisentado y llamar 112", "Caminar para calmar el dolor", "Administrar agua"],
                    correct: 1,
                    tip: "En sospecha de Infarto, la posición semisentado reduce el esfuerzo del corazón."
                }
            ];

            const handleAnswer = (idx) => {
                if (feedback !== null) return;
                const isCorrect = idx === quiz[currentQuestion].correct;
                if (isCorrect) setScore(score + 1);
                setFeedback(isCorrect ? 'correct' : 'incorrect');
                setTimeout(() => {
                    setFeedback(null);
                    if (currentQuestion + 1 < quiz.length) setCurrentQuestion(currentQuestion + 1);
                    else setShowResult(true);
                }, 2000);
            };

            return (
                <div className="min-h-screen pb-12">
                    <header className="bg-indigo-700 text-white pt-8 pb-12 px-6 shadow-lg text-center">
                        <h1 className="text-2xl font-black flex justify-center items-center gap-2">
                            <Icon name="activity" className="w-8 h-8" /> SIMULADOR ORGÁNICO
                        </h1>
                        <p className="text-indigo-200 text-xs mt-2 uppercase tracking-widest">Protocolos de Primeros Auxilios</p>
                    </header>

                    <main className="max-w-4xl mx-auto px-4 -mt-6">
                        <div className="flex bg-white p-1 rounded-xl shadow-md mb-6 justify-center max-w-xs mx-auto">
                            <button onClick={() => setActiveTab('learning')} className={`px-6 py-2 rounded-lg text-sm font-bold transition ${activeTab === 'learning' ? 'bg-indigo-600 text-white' : 'text-slate-500'}`}>Protocolos</button>
                            <button onClick={() => setActiveTab('quiz')} className={`px-6 py-2 rounded-lg text-sm font-bold transition ${activeTab === 'quiz' ? 'bg-indigo-600 text-white' : 'text-slate-500'}`}>Simulador</button>
                        </div>

                        {activeTab === 'learning' ? (
                            <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
                                <div className="space-y-3">
                                    {pathologies.map(p => (
                                        <button key={p.id} onClick={() => setSelectedPathology(p)} className={`w-full text-left p-4 bg-white rounded-xl border-2 transition ${selectedPathology?.id === p.id ? 'border-indigo-500' : 'border-transparent shadow-sm'}`}>
                                            <div className="flex items-center gap-3">
                                                <div className={`${p.bg} ${p.color} p-2 rounded-lg`}><Icon name={p.icon} className="w-5 h-5" /></div>
                                                <span className="font-bold text-sm text-slate-800">{p.subtitle}</span>
                                            </div>
                                        </button>
                                    ))}
                                </div>
                                <div className="md:col-span-2">
                                    {selectedPathology ? (
                                        <div className="bg-white p-8 rounded-2xl shadow-xl border-t-4 border-indigo-500">
                                            <h2 className="text-xl font-black mb-4">{selectedPathology.title}</h2>
                                            <div className="space-y-6">
                                                <div>
                                                    <h3 className="text-xs font-black uppercase text-slate-400 mb-2">Síntomas Clave</h3>
                                                    <ul className="text-sm space-y-1">{selectedPathology.symptoms.map((s, i) => <li key={i} className="flex items-center gap-2"><Icon name="check" className="w-3 h-3 text-emerald-500" /> {s}</li>)}</ul>
                                                </div>
                                                <div>
                                                    <h3 className="text-xs font-black uppercase text-slate-400 mb-2">Actuación</h3>
                                                    {selectedPathology.actions.map((a, i) => <div key={i} className="mb-2 text-sm"><strong>{a.step}:</strong> {a.text}</div>)}
                                                </div>
                                            </div>
                                        </div>
                                    ) : (
                                        <div className="h-40 border-2 border-dashed rounded-2xl flex items-center justify-center text-slate-400">Selecciona una patología</div>
                                    )}
                                </div>
                            </div>
                        ) : (
                            <div className="bg-white p-8 rounded-2xl shadow-xl max-w-xl mx-auto">
                                {!quizStarted ? (
                                    <div className="text-center">
                                        <Icon name="zap" className="w-12 h-12 text-indigo-500 mx-auto mb-4" />
                                        <h2 className="text-lg font-black mb-2">Modo Simulación</h2>
                                        <p className="text-slate-500 text-sm mb-6">Demuestra tus conocimientos en casos reales.</p>
                                        <button onClick={() => setQuizStarted(true)} className="bg-indigo-600 text-white px-8 py-3 rounded-xl font-bold">Empezar</button>
                                    </div>
                                ) : showResult ? (
                                    <div className="text-center">
                                        <h2 className="text-3xl font-black text-indigo-600 mb-2">{Math.round((score/quiz.length)*100)}%</h2>
                                        <p className="text-slate-600 mb-6">Has completado el entrenamiento.</p>
                                        <button onClick={() => {setQuizStarted(false); setShowResult(false); setScore(0);}} className="text-indigo-600 font-bold">Reiniciar</button>
                                    </div>
                                ) : (
                                    <div>
                                        <p className="text-sm font-bold italic mb-6">"{quiz[currentQuestion].case}"</p>
                                        <div className="space-y-3">
                                            {quiz[currentQuestion].options.map((o, i) => (
                                                <button key={i} onClick={() => handleAnswer(i)} className="w-full p-4 text-left border-2 rounded-xl text-sm font-semibold hover:bg-indigo-50 transition">{o}</button>
                                            ))}
                                        </div>
                                        {feedback && <div className="mt-4 p-4 bg-slate-100 rounded-lg text-xs font-bold text-indigo-700">{quiz[currentQuestion].tip}</div>}
                                    </div>
                                )}
                            </div>
                        )}
                    </main>
                    <footer className="text-center mt-12 text-slate-400 text-[10px] font-bold uppercase tracking-widest">
                        Emergencias: 112 | Módulo Sanitario FP
                    </footer>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
